{% extends "base.html" %}
{% load static from staticfiles %}
{% load bootstrap_tags %}

{% block head_js %}
<script type="text/javascript" src="https://js.stripe.com/v2/"></script>
<script type="text/javascript">
    //<![CDATA[
    Stripe.publishableKey = '{{ publishable }}';
    //]]>
</script>
<script type="text/javascript" src="{% static 'js/stripe.js' %}"></script>
{% endblock %}


{% block content %}
<div class="row">
    <div class="col-md-10 offset-md-1 text-center">
    
    <!-- Payment form and form which takes the donate value to store on user db -->
    <form role="form" method="post" id="payment-form" action="{% url 'donate' %}" class="accountform form-horizontal justify-content-center">
        <legend class="ml-3 ml-sm-4 pl-3 pb-1" style="background-color: #00ffff;width: 90%;"><i class="fa fa-credit-card mr-1" aria-hidden="true"></i>Payment Details</legend>
        
        <!-- for any credit card errors that come back -->
        <div id="credit-card-errors" style="display: none;">
            <!-- if errors come back, we display stripe-error-message -->
            <div class="alert-message block-message error" id="stripe-error-message"></div>
        </div>
        
        <div class="form-group col-md-6 offset-md-3">
            {{ donate_model_form | as_bootstrap }}
        </div>
        
        <div class="form-group col-md-6 offset-md-3">
            {{ donation_form | as_bootstrap }}
        </div> 
        
        {% csrf_token %}
        <div class="form-group col-md-12">
            <input class="btn btn-primary" id="submit_payment_btn" name="commit" type="submit" value="Submit Payment">
        </div>
    </form>
    
   </div> 
</div>
{% endblock %}


{% block body_end_js %}
<script>
    const today = new Date();
    // change value selected into current month
    $('#id_expiry_month option:eq('+today.getMonth()+')').prop('selected', true);
    
    $(".container").addClass("form-creation-shift");

    // footer responsive stay at bottom
    $(window).on('resize', function(){
        const w = window.innerWidth;
        const h = window.innerHeight;
        if (w >= 350 && h >= 800) {
            $("footer").css({'position' : 'absolute', 'bottom' : 0});
        }
        else {
            $("footer").css({'position' : 'inherit'});
        }
    }).resize();        
</script>
{% endblock body_end_js %}

